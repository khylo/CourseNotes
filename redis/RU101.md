# Redis University 101 Introduction to Redis Data Structures
See https://university.redis.com/courses/course-v1:redislabs+RU101+2022_07/courseware/3f48285e65d245419daadc40da4a38bc/b1687f28f87a4138a860fa7bf4e8a2f1/?child=first

Overview.
Redis is an in-memory but persistent on disk database, so it represents a different trade off where very high write and read speed is achieved with the limitation of data sets that can't be larger than memory
Testing your use case is trivial. Use the redis-benchmark utility to generate random data sets then check the space used with the INFO memory command.

https://redis.io/docs/getting-started/faq/
## Redis Data Structures
### Keys
Amy binary structure can be a key, up to 512 MB
Lenght vs readability

### Logical Databases 
logical database is identified by a zero-based index. The default is database 0.  Within a logical database, the key names are unique as mentioned. 
But the same key name can appear in multiple logical databases,

In practical terms, they are best  suited when you need separate key spaces for a single application rather than separating

REdis cluster only supports Database 0

Normally just using database 0

Often colo : used to seperate parts of names..

Case sensitive.. 

e.g. user:1000:followers


## Redis commands
Cheatsheet. https://gist.github.com/LeCoupa/1596b8f359ad8812c7271b5322c30946
https://lzone.de/cheat-sheet/Redis

YouTube tut. https://youtu.be/jgpVdJB2sKQ

set customer:10000 fred   [EX seconds] [PC mills] [NX| XX] ## Can be atomic, and check if key does not exist (NX) or already exists XX (update)
get customer:10000

# Can set keys to expire using 
EXPIRE # in seconds
or PXPIRE # in milli seconds

TTL <key> # THis will show how much time left before key expires

PERSIST <key> # this will make key persistent (not expire) 

keys    # ALways block until complete. Never use in Prod.. Useful fo debuggin at non-Prod
scan # Iterates using cursor.. Blcoks but only for iteration

keys *
keys custome:1*

## Can increase or decrase values if encoded as number int
INCR <key>
INCRBY <key> <amount>
DECRBy <key> <amount>

TYPE <key>  # returns type of key.. Note often string, but if its a number thne can be incr or decr

OBJECT encoding <key>  # returns encoding.. Can change over time e.g. in example ru101 was int, then encstr..  

scan 0 MATCH customer:1*    # May need to run multiple times using start point returned each time

del <key>   delete key, and clear memory.. blolcks
unlink customer:1000   # Returns number of keys removed.. removes link.. not blocking. Memory remvoed as part of async cleanup
exists customer:10000


Finished on week 1 Keys.. Strings next


# Types
See https://redis.io/docs/data-types/

* Strings. 
Redis string is a sequence of bytes. ...
* Hashes. 
A Redis hash is a collection of key value pairs. ...
* Lists. 
Redis Lists are simply lists of strings, sorted by insertion order. ...
* Sets. 
Redis Sets are an unordered collection of strings. ...
* Sorted Sets.
maintain order by each string's associated score. 
Lookups etc O(log n)
See example in RU102J uses, e.g. needs to make these unique so no clashes . THats why min is at end
KEY = prefix:metric:day:siteId:temp:min, e.g. 18 Wattss at 1 min on date   
app:metric:whG:2022-09-30:18.0:1  
VALIE = temp:minute to generate unique key
store  multiple metrics in key, and allow us to query range

* Streams
A Redis stream is a data structure that acts like an append-only log. Streams help record events in the order they occur and then syndicate them for processing. For more information.
Redis streams support several trimming strategies (to prevent streams from growing unbounded) and more than one consumption strategy (see XREAD, XREADGROUP, and XRANGE).

* Geospacial indexes
Redis geospatial indexes are useful for finding locations within a given geographic radius or bounding box. For more information:
* Bitmaps
let you perform bitwise operations on strings. 
* Bitfields
efficiently encode multiple counters in a string value. Bitfields provide atomic get, set, and increment operations and support different overflow policies. For more information
* 

## Operations
keys
smembers
zrange
zrevrange    
zRevRangeWithScores    
reverese range with scores